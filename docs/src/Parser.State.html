<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">{-|
  A module containing the `Parser.State` data type,
  which is used in Parser.ParseT to represent the changing
  state while parsing.
-}</span><span>
</span><a name="line-6"></a><span>
</span><a name="line-7"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Parser</span><span class="hs-operator">.</span><span class="hs-identifier">State</span><span> </span><span class="hs-special">(</span><span>
</span><a name="line-8"></a><span>  </span><a href="Parser.State.html#State"><span class="hs-identifier hs-type">State</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="Parser.State.html#ParseError"><span class="hs-identifier hs-type">ParseError</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="Parser.State.html#Loc"><span class="hs-identifier hs-type">Loc</span></a><span class="hs-special">,</span><span> </span><a href="Parser.State.html#Label"><span class="hs-identifier hs-type">Label</span></a><span class="hs-special">,</span><span>
</span><a name="line-9"></a><span>  </span><a href="Parser.State.html#labelState"><span class="hs-identifier hs-var">labelState</span></a><span class="hs-special">,</span><span> </span><a href="Parser.State.html#defaultState"><span class="hs-identifier hs-var">defaultState</span></a><span class="hs-special">,</span><span>
</span><a name="line-10"></a><span>  </span><a href="Parser.State.html#incCol"><span class="hs-identifier hs-var">incCol</span></a><span class="hs-special">,</span><span> </span><a href="Parser.State.html#incLine"><span class="hs-identifier hs-var">incLine</span></a><span class="hs-special">,</span><span> </span><a href="Parser.State.html#resetCol"><span class="hs-identifier hs-var">resetCol</span></a><span class="hs-special">,</span><span> </span><a href="Parser.State.html#clearExpected"><span class="hs-identifier hs-var">clearExpected</span></a><span class="hs-special">,</span><span> </span><a href="Parser.State.html#updateError"><span class="hs-identifier hs-var">updateError</span></a><span>
</span><a name="line-11"></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-12"></a><span>
</span><a name="line-13"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">List</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">intercalate</span><span class="hs-special">)</span><span>
</span><a name="line-14"></a><span>
</span><a name="line-15"></a><span class="hs-comment">-- | The state data type</span><span>
</span><a name="line-16"></a><span class="hs-comment">-- It keeps track of the remaining input,</span><span>
</span><a name="line-17"></a><span class="hs-comment">-- the location, whether or not input has</span><span>
</span><a name="line-18"></a><span class="hs-comment">-- been consumed, and the error stack.</span><span>
</span><a name="line-19"></a><span class="hs-keyword">data</span><span> </span><a name="State"><a href="Parser.State.html#State"><span class="hs-identifier">State</span></a></a><span> </span><a name="local-6989586621679031844"><a href="#local-6989586621679031844"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="State"><a href="Parser.State.html#State"><span class="hs-identifier">State</span></a></a><span> </span><span class="hs-special">{</span><span>
</span><a name="line-20"></a><span>  </span><a name="inp"><a href="Parser.State.html#inp"><span class="hs-identifier">inp</span></a></a><span>        </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679031844"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span>
</span><a name="line-21"></a><span>  </span><a name="loc"><a href="Parser.State.html#loc"><span class="hs-identifier">loc</span></a></a><span>        </span><span class="hs-glyph">::</span><span> </span><a href="Parser.State.html#Loc"><span class="hs-identifier hs-type">Loc</span></a><span class="hs-special">,</span><span>
</span><a name="line-22"></a><span>  </span><a name="consumed"><a href="Parser.State.html#consumed"><span class="hs-identifier">consumed</span></a></a><span>   </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Bool</span><span class="hs-special">,</span><span>
</span><a name="line-23"></a><span>  </span><a name="parseError"><a href="Parser.State.html#parseError"><span class="hs-identifier">parseError</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Parser.State.html#ParseError"><span class="hs-identifier hs-type">ParseError</span></a><span> </span><a href="#local-6989586621679031844"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-24"></a><span class="hs-special">}</span><span>
</span><a name="line-25"></a><span>
</span><a name="line-26"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><a href="#local-6989586621679032024"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><span class="hs-special">(</span><a href="Parser.State.html#State"><span class="hs-identifier hs-type">State</span></a><span> </span><a href="#local-6989586621679032024"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-27"></a><span>  </span><a name="local-8214565720323791019"><span class="hs-identifier">show</span></a><span> </span><a name="local-6989586621679032025"><a href="#local-6989586621679032025"><span class="hs-identifier">st</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679032026"><span class="hs-identifier hs-var">showLoc</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679032027"><span class="hs-identifier hs-var">showErr</span></a><span>
</span><a name="line-28"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-29"></a><span>      </span><a name="local-6989586621679032026"><a href="#local-6989586621679032026"><span class="hs-identifier">showLoc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">loc</span><span> </span><a href="#local-6989586621679032025"><span class="hs-identifier hs-var">st</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;\n&quot;</span><span>
</span><a name="line-30"></a><span>      </span><a name="local-6989586621679032027"><a href="#local-6989586621679032027"><span class="hs-identifier">showErr</span></a></a><span>
</span><a name="line-31"></a><span>        </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">null</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">expected</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">parseError</span><span> </span><a href="#local-6989586621679032025"><span class="hs-identifier hs-var">st</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;&quot;</span><span>
</span><a name="line-32"></a><span>        </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">parseError</span><span> </span><a href="#local-6989586621679032025"><span class="hs-identifier hs-var">st</span></a><span class="hs-special">)</span><span>
</span><a name="line-33"></a><span>
</span><a name="line-34"></a><span class="hs-comment">-- | The location data type.</span><span>
</span><a name="line-35"></a><span class="hs-comment">-- This is used to keep track of the location</span><span>
</span><a name="line-36"></a><span class="hs-comment">-- in the `State` data type.</span><span>
</span><a name="line-37"></a><span class="hs-keyword">data</span><span> </span><a name="Loc"><a href="Parser.State.html#Loc"><span class="hs-identifier">Loc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="Loc"><a href="Parser.State.html#Loc"><span class="hs-identifier">Loc</span></a></a><span> </span><span class="hs-special">{</span><span>
</span><a name="line-38"></a><span>  </span><a name="file"><a href="Parser.State.html#file"><span class="hs-identifier">file</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span class="hs-special">,</span><span>
</span><a name="line-39"></a><span>  </span><a name="line"><a href="Parser.State.html#line"><span class="hs-identifier">line</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span class="hs-special">,</span><span>
</span><a name="line-40"></a><span>  </span><a name="col"><a href="Parser.State.html#col"><span class="hs-identifier">col</span></a></a><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-41"></a><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-identifier hs-type">Eq</span><span>
</span><a name="line-42"></a><span>
</span><a name="line-43"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><a href="Parser.State.html#Loc"><span class="hs-identifier hs-type">Loc</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-44"></a><span>  </span><a name="local-8214565720323791019"><span class="hs-identifier">show</span></a><span> </span><a name="local-6989586621679032023"><a href="#local-6989586621679032023"><span class="hs-identifier">l</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">file</span><span> </span><a href="#local-6989586621679032023"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;:&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">line</span><span> </span><a href="#local-6989586621679032023"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;:&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">col</span><span> </span><a href="#local-6989586621679032023"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">)</span><span>
</span><a name="line-45"></a><span>
</span><a name="line-46"></a><span class="hs-comment">-- | A label used to explain what was expected when the the `ParseError` occured.</span><span>
</span><a name="line-47"></a><span class="hs-keyword">type</span><span> </span><a name="Label"><a href="Parser.State.html#Label"><span class="hs-identifier">Label</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-48"></a><span>
</span><a name="line-49"></a><span class="hs-comment">-- | A data type used to represent an error while parsing.</span><span>
</span><a name="line-50"></a><span class="hs-comment">-- This is used to generate a trace of what a parser expected, what</span><span>
</span><a name="line-51"></a><span class="hs-comment">-- the parser got, and where the error occured.</span><span>
</span><a name="line-52"></a><span class="hs-keyword">data</span><span> </span><a name="ParseError"><a href="Parser.State.html#ParseError"><span class="hs-identifier">ParseError</span></a></a><span> </span><a name="local-6989586621679031843"><a href="#local-6989586621679031843"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="ParseError"><a href="Parser.State.html#ParseError"><span class="hs-identifier">ParseError</span></a></a><span> </span><span class="hs-special">{</span><span>
</span><a name="line-53"></a><span>  </span><a name="actual"><a href="Parser.State.html#actual"><span class="hs-identifier">actual</span></a></a><span>   </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679031843"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span>
</span><a name="line-54"></a><span>  </span><a name="expected"><a href="Parser.State.html#expected"><span class="hs-identifier">expected</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Parser.State.html#Label"><span class="hs-identifier hs-type">Label</span></a><span class="hs-special">]</span><span>
</span><a name="line-55"></a><span class="hs-special">}</span><span>
</span><a name="line-56"></a><span>
</span><a name="line-57"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><a href="#local-6989586621679031845"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><span class="hs-special">(</span><a href="Parser.State.html#ParseError"><span class="hs-identifier hs-type">ParseError</span></a><span> </span><a href="#local-6989586621679031845"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-58"></a><span>  </span><a name="local-8214565720323791019"><span class="hs-identifier">show</span></a><span> </span><a name="local-6989586621679031846"><a href="#local-6989586621679031846"><span class="hs-identifier">pe</span></a></a><span>
</span><a name="line-59"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">actual</span><span> </span><a href="#local-6989586621679031846"><span class="hs-identifier hs-var">pe</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-string">&quot;\&quot;\&quot;&quot;</span><span>
</span><a name="line-60"></a><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;Unexpected end of input&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679031847"><span class="hs-identifier hs-var">showExpected</span></a><span>
</span><a name="line-61"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;Found: &quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">actual</span><span> </span><a href="#local-6989586621679031846"><span class="hs-identifier hs-var">pe</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679031847"><span class="hs-identifier hs-var">showExpected</span></a><span>
</span><a name="line-62"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-63"></a><span>      </span><a name="local-6989586621679031847"><a href="#local-6989586621679031847"><span class="hs-identifier">showExpected</span></a></a><span>
</span><a name="line-64"></a><span>        </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">length</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">expected</span><span> </span><a href="#local-6989586621679031846"><span class="hs-identifier hs-var">pe</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-number">1</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;\nExpected: &quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">concat</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">expected</span><span> </span><a href="#local-6989586621679031846"><span class="hs-identifier hs-var">pe</span></a><span class="hs-special">)</span><span>
</span><a name="line-65"></a><span>        </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;\nExpected: &quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">intercalate</span><span> </span><span class="hs-string">&quot;, &quot;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">reverse</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">tail</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">expected</span><span> </span><a href="#local-6989586621679031846"><span class="hs-identifier hs-var">pe</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot; or &quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">head</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">expected</span><span> </span><a href="#local-6989586621679031846"><span class="hs-identifier hs-var">pe</span></a><span class="hs-special">)</span><span>
</span><a name="line-66"></a><span>
</span><a name="line-67"></a><span class="hs-comment">-- | Generates a state with the given filepath and input.</span><span>
</span><a name="line-68"></a><span class="hs-identifier">defaultState</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">FilePath</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679032033"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Parser.State.html#State"><span class="hs-identifier hs-type">State</span></a><span> </span><a href="#local-6989586621679032033"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-69"></a><a name="defaultState"><a href="Parser.State.html#defaultState"><span class="hs-identifier">defaultState</span></a></a><span> </span><a name="local-6989586621679032170"><a href="#local-6989586621679032170"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679032171"><a href="#local-6989586621679032171"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-70"></a><span>  </span><a href="Parser.State.html#State"><span class="hs-identifier hs-var">State</span></a><span> </span><span class="hs-special">{</span><span>
</span><a name="line-71"></a><span>    </span><span class="hs-identifier">inp</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679032171"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">,</span><span>
</span><a name="line-72"></a><span>    </span><span class="hs-identifier">loc</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Parser.State.html#Loc"><span class="hs-identifier hs-var">Loc</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">file</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679032170"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">line</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">1</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">col</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">1</span><span> </span><span class="hs-special">}</span><span class="hs-special">,</span><span>
</span><a name="line-73"></a><span>    </span><span class="hs-identifier">consumed</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span class="hs-special">,</span><span>
</span><a name="line-74"></a><span>    </span><span class="hs-identifier">parseError</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Parser.State.html#ParseError"><span class="hs-identifier hs-var">ParseError</span></a><span> </span><span class="hs-special">{</span><span>
</span><a name="line-75"></a><span>        </span><span class="hs-identifier">actual</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679032171"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">,</span><span>
</span><a name="line-76"></a><span>        </span><span class="hs-identifier">expected</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-77"></a><span>    </span><span class="hs-special">}</span><span>
</span><a name="line-78"></a><span>  </span><span class="hs-special">}</span><span>
</span><a name="line-79"></a><span>
</span><a name="line-80"></a><span class="hs-identifier">setLine</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">setCol</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Parser.State.html#State"><span class="hs-identifier hs-type">State</span></a><span> </span><a href="#local-6989586621679032032"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Parser.State.html#State"><span class="hs-identifier hs-type">State</span></a><span> </span><a href="#local-6989586621679032032"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-81"></a><a name="setLine"><a href="Parser.State.html#setLine"><span class="hs-identifier">setLine</span></a></a><span> </span><a name="local-6989586621679032172"><a href="#local-6989586621679032172"><span class="hs-identifier">i</span></a></a><span> </span><a name="local-6989586621679032173"><a href="#local-6989586621679032173"><span class="hs-identifier">st</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679032173"><span class="hs-identifier hs-var">st</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">loc</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">loc</span><span> </span><a href="#local-6989586621679032173"><span class="hs-identifier hs-var">st</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">line</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679032172"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-82"></a><a name="setCol"><a href="Parser.State.html#setCol"><span class="hs-identifier">setCol</span></a></a><span> </span><a name="local-6989586621679032174"><a href="#local-6989586621679032174"><span class="hs-identifier">i</span></a></a><span> </span><a name="local-6989586621679032175"><a href="#local-6989586621679032175"><span class="hs-identifier">st</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679032175"><span class="hs-identifier hs-var">st</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">loc</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">loc</span><span> </span><a href="#local-6989586621679032175"><span class="hs-identifier hs-var">st</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">col</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679032174"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-83"></a><span>
</span><a name="line-84"></a><span class="hs-comment">-- | Function that edits the location of the `State`</span><span>
</span><a name="line-85"></a><span class="hs-identifier">incLine</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">incCol</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">resetCol</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Parser.State.html#State"><span class="hs-identifier hs-type">State</span></a><span> </span><a href="#local-6989586621679032031"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Parser.State.html#State"><span class="hs-identifier hs-type">State</span></a><span> </span><a href="#local-6989586621679032031"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-86"></a><a name="incLine"><a href="Parser.State.html#incLine"><span class="hs-identifier">incLine</span></a></a><span> </span><a name="local-6989586621679032176"><a href="#local-6989586621679032176"><span class="hs-identifier">st</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Parser.State.html#setLine"><span class="hs-identifier hs-var">setLine</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">line</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">loc</span><span> </span><a href="#local-6989586621679032176"><span class="hs-identifier hs-var">st</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679032176"><span class="hs-identifier hs-var">st</span></a><span>
</span><a name="line-87"></a><a name="incCol"><a href="Parser.State.html#incCol"><span class="hs-identifier">incCol</span></a></a><span> </span><a name="local-6989586621679032177"><a href="#local-6989586621679032177"><span class="hs-identifier">st</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Parser.State.html#setCol"><span class="hs-identifier hs-var">setCol</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">col</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">loc</span><span> </span><a href="#local-6989586621679032177"><span class="hs-identifier hs-var">st</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679032177"><span class="hs-identifier hs-var">st</span></a><span>
</span><a name="line-88"></a><a name="resetCol"><a href="Parser.State.html#resetCol"><span class="hs-identifier">resetCol</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Parser.State.html#setCol"><span class="hs-identifier hs-var">setCol</span></a><span> </span><span class="hs-number">0</span><span>
</span><a name="line-89"></a><span>
</span><a name="line-90"></a><span class="hs-comment">-- | Add an error to the `State` stack with the given label.</span><span>
</span><a name="line-91"></a><span class="hs-identifier">labelState</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Parser.State.html#Label"><span class="hs-identifier hs-type">Label</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Parser.State.html#State"><span class="hs-identifier hs-type">State</span></a><span> </span><a href="#local-6989586621679032030"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Parser.State.html#State"><span class="hs-identifier hs-type">State</span></a><span> </span><a href="#local-6989586621679032030"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-92"></a><a name="labelState"><a href="Parser.State.html#labelState"><span class="hs-identifier">labelState</span></a></a><span> </span><a name="local-6989586621679032178"><a href="#local-6989586621679032178"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679032179"><a href="#local-6989586621679032179"><span class="hs-identifier">st</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679032179"><span class="hs-identifier hs-var">st</span></a><span> </span><span class="hs-special">{</span><span>
</span><a name="line-93"></a><span>    </span><span class="hs-identifier">parseError</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-94"></a><span>      </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679032180"><a href="#local-6989586621679032180"><span class="hs-identifier">old</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">parseError</span><span> </span><a href="#local-6989586621679032179"><span class="hs-identifier hs-var">st</span></a><span>
</span><a name="line-95"></a><span>       </span><span class="hs-keyword">in</span><span> </span><a href="#local-6989586621679032180"><span class="hs-identifier hs-var">old</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">expected</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679032178"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-identifier">expected</span><span> </span><a href="#local-6989586621679032180"><span class="hs-identifier hs-var">old</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-96"></a><span>  </span><span class="hs-special">}</span><span>
</span><a name="line-97"></a><span>
</span><a name="line-98"></a><span class="hs-comment">-- | Clear the expected list</span><span>
</span><a name="line-99"></a><span class="hs-identifier">clearExpected</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Parser.State.html#State"><span class="hs-identifier hs-type">State</span></a><span> </span><a href="#local-6989586621679032029"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Parser.State.html#State"><span class="hs-identifier hs-type">State</span></a><span> </span><a href="#local-6989586621679032029"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-100"></a><a name="clearExpected"><a href="Parser.State.html#clearExpected"><span class="hs-identifier">clearExpected</span></a></a><span> </span><a name="local-6989586621679032181"><a href="#local-6989586621679032181"><span class="hs-identifier">st</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679032181"><span class="hs-identifier hs-var">st</span></a><span> </span><span class="hs-special">{</span><span>
</span><a name="line-101"></a><span>    </span><span class="hs-identifier">parseError</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">parseError</span><span> </span><a href="#local-6989586621679032181"><span class="hs-identifier hs-var">st</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">expected</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-102"></a><span>  </span><span class="hs-special">}</span><span>
</span><a name="line-103"></a><span>
</span><a name="line-104"></a><span class="hs-comment">-- | Update the remaining input in the error</span><span>
</span><a name="line-105"></a><span class="hs-identifier">updateError</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Parser.State.html#State"><span class="hs-identifier hs-type">State</span></a><span> </span><a href="#local-6989586621679032028"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Parser.State.html#State"><span class="hs-identifier hs-type">State</span></a><span> </span><a href="#local-6989586621679032028"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-106"></a><a name="updateError"><a href="Parser.State.html#updateError"><span class="hs-identifier">updateError</span></a></a><span> </span><a name="local-6989586621679032182"><a href="#local-6989586621679032182"><span class="hs-identifier">st</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679032182"><span class="hs-identifier hs-var">st</span></a><span> </span><span class="hs-special">{</span><span>
</span><a name="line-107"></a><span>    </span><span class="hs-identifier">parseError</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">parseError</span><span> </span><a href="#local-6989586621679032182"><span class="hs-identifier hs-var">st</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">actual</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">inp</span><span> </span><a href="#local-6989586621679032182"><span class="hs-identifier hs-var">st</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-108"></a><span>  </span><span class="hs-special">}</span><span>
</span><a name="line-109"></a></pre></body></html>